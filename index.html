<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #map {
            width: 100%;
            height: 400px;
        }
    </style>
</head>

<body>
    <div id="map"></div>


    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBa6oIOta-5DkFn98ubdcI6FA4h76jsDeo&libraries=places"></script>
    <script>
        const map = new google.maps.Map(document.getElementById('map'), {
            center: { lat: 0, lng: 0 },
            zoom: 20
        });

        let currentLocation = 'Urjanagar Gate/ Koyna gate'
        // Create geocoder instance
        const geocoder = new google.maps.Geocoder();

        // Geocode the current location city
        geocoder.geocode({ address: currentLocation }, function (results, status) {
            if (status === google.maps.GeocoderStatus.OK && results.length > 0) {
                const currentLocationLatLng = results[0].geometry.location;
                // Create a marker for the current location city
                const currentLocationMarker = new google.maps.Marker({
                    position: currentLocationLatLng,
                    map: map,
                    icon: '/public/images/bus-icon.png',
                    title: 'Current Location: ' + currentLocation
                });

                // Adjust the map center to include the current location marker
                map.setCenter(currentLocationLatLng)
            } else {
                console.log('Error geocoding current location city:', status);
            }
        });

        
        // displayMapRoute("", "Mumbai", "Pune", "Lonavla");
        function displayMapRoute(name, origin, destination, currentLocation) {
            const originCity = origin;
            const destinationCity = destination;

            const map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 0, lng: 0 },
                zoom: 8
            });

            const directionsService = new google.maps.DirectionsService();
            const directionsRenderer = new google.maps.DirectionsRenderer({
                map: map
            });

            const request = {
                origin: originCity,
                destination: destinationCity,
                travelMode: google.maps.TravelMode.DRIVING
            };

            directionsService.route(request, function (response, status) {
                if (status === google.maps.DirectionsStatus.OK) {
                    directionsRenderer.setDirections(response);

                    // Create geocoder instance
                    const geocoder = new google.maps.Geocoder();

                    // Geocode the current location city
                    geocoder.geocode({ address: currentLocation }, function (results, status) {
                        if (status === google.maps.GeocoderStatus.OK && results.length > 0) {
                            const currentLocationLatLng = results[0].geometry.location;
                            // Create a marker for the current location city
                            const currentLocationMarker = new google.maps.Marker({
                                position: currentLocationLatLng,
                                map: map,
                                // icon: '/static/images/bus-icon.png',
                                title: 'Current Location: ' + currentLocation
                            });

                            // Adjust the map center to include the current location marker
                            map.setCenter(currentLocationLatLng)
                        } else {
                            console.log('Error geocoding current location city:', status);
                        }
                    });

                    // Update the map center and zoom level to include the current location
                    const bounds = new google.maps.LatLngBounds();
                    // bounds.extend(currentLocation);
                    bounds.extend(request.origin);
                    bounds.extend(request.destination);
                    map.fitBounds(bounds);
                } else {
                    console.log('Error:', status);
                }
            });
        }

    </script>

</body>

</html>